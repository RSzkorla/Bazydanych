//LAB1
select * from Employees
select LastName, FirstName from Employees - rzut pionowy
select LastName, FirstName from Employees where LastName='Peacock' -rzut poziomy + pionowy
select LastName, FirstName from Employees where LastName='Peacock' and FirstName = 'Margaret'
select LastName, FirstName from Employees where LastName='Peacock' or LastName = 'Chicken'
select LastName, FirstName from Employees where LastName='Peacock' or LastName = 'Chicken' or LastName = 'Fuller'
select LastName, FirstName from Employees where LastName in ('Peacock','Chicken','Fuller')
select * from Products where UnitPrice > 20
select * from Products where CategoryID in (8,9,10)
select ProductName,UnitPrice from Products where UnitPrice > 20
select ProductName, CategoryID from Products where CategoryID in (8,9,10)
select ProductName,UnitPrice from Products where UnitPrice > 20 order by UnitPrice
select ProductName,UnitPrice from Products where UnitPrice > 20 order by CategoryID , UnitPrice
select ProductName,UnitPrice from Products where UnitPrice > 20 order by CategoryID desc, UnitPrice asc

//LAB2
SELECT ProductName FROM Products
SELECT ProductName, UnitPrice FROM Products WHERE UnitPrice BETWEEN 20 AND 25
SELECT ProductName, UnitPrice, CategoryID FROM Products WHERE(UnitPrice <10) AND CategoryID IN (7,8)
SELECT FirstName, LastName, DATEDIFF(YY,HireDate,GETDATE()) AS 'Sta¿' FROM Employees WHERE DATEDIFF(YY,HireDate,GETDATE()) >20
SELECT FirstName, LastName FROM Employees WHERE LastName LIKE 'K%'
SELECT ProductName, CategoryName FROM Products, Categories  WHERE Products.CategoryID = Categories.CategoryID ORDER BY ProductName
SELECT CompanyName, OrderDate FROM Orders,Customers WhERE Orders.CustomerID=Customers.CustomerID ORDER by CompanyName
SELECT LastName, CustomerID From Employees, Orders WHERE Employees.EmployeeID = Orders.EmployeeID ORDER BY LastName
SELECT LastName FROM Employees, Orders Where OrderDate='1996-10-21' AND Employees.EmployeeID=Orders.EmployeeID ORDER BY LastName
SELECT LastName, CompanyName From Employees, Orders, Customers WHERE Employees.EmployeeID = Orders.EmployeeID AND Orders.CustomerID=Customers.CustomerID ORDER BY LastName 
SELECT p.LastName as robol, sz.LastName as szef From Employees as p, Employees as sz Where p.ReportsTo= sz.EmployeeID 

//LAB3
SELECT ProductName, CategoryName, CompanyName 
FROM Products, Categories, Suppliers 
WHERE Products.CategoryID = Categories.CategoryID 
	AND Suppliers.SupplierID = Products.SupplierID
ORDER BY CompanyName, CategoryName, ProductName 

SELECT Customers.City FROM Customers, Orders WHERE Orders.CustomerID = Customers.CustomerID

SELECT City FROM Customers JOIN Orders ON Customers.CustomerID = Orders.CustomerID

SELECT ProductName, CategoryName, CompanyName 
FROM Products JOIN Categories 
	ON Products.CategoryID = Categories.CategoryID JOIN Suppliers 
	ON Suppliers.SupplierID = Products.SupplierID
ORDER BY CompanyName, CategoryName, ProductName 

INSERT INTO Categories (CategoryName) VALUES ('European')

SELECT ProductName, CategoryName FROM Products FULL OUTER JOIN Categories ON Products.CategoryID = Categories.CategoryID

SELECT p.LastName as robol, sz.LastName as szef 
From Employees as p LEFT JOIN Employees as sz ON p.ReportsTo= sz.EmployeeID 

// LAB4

SELECT Orders.OrderID, ProductName, Quantity, OrderDate
FROM Products, Orders,[Order Details]
WHERE Products.ProductID = [Order Details].ProductID
	AND Orders.OrderID = [Order Details].OrderID
	
SELECT LastName, OrderID
FROM Employees 
LEFT JOIN Orders
ON Employees.EmployeeID = Orders.EmployeeID
ORDER BY LastName

SELECT ProductID, CompanyName
FROM Products 
RIGHT JOIN Suppliers
ON Products.SupplierID = Suppliers.SupplierID
ORDER BY CompanyName

SELECT LastName, OrderID
FROM Employees 
FULL JOIN Orders
ON Employees.EmployeeID = Orders.EmployeeID
WHERE OrderID IS NULL
ORDER BY LastName

SELECT p.LastName as robol, sz.LastName as szef 
From Employees as p 
LEFT JOIN Employees as sz 
ON p.ReportsTo= sz.EmployeeID 
WHERE p.ReportsTo IS NULL

SELECT ProductName
FROM Products
FULL JOIN [Order Details]
ON Products.ProductID = [Order Details].ProductID
WHERE OrderID IS NULL

CREATE TABLE DaysOfWeek(
	DayOfWeek varchar(20) PRIMARY KEY NOT NULL)
	
SELECT Dzien 
FROM DaysOfWeek
FULL JOIN Orders 
ON DATENAME(DW,OrderDate) = Dzien
WHERE DATENAME(DW,OrderDate) IS NULL



select FirstName, LastName 
from Employees 
where DATEDIFF(YYYY,HireDate,GETDATE()) > 10 
and City in ('Boston','Orlean')

select DISTINCT LastName 
from Employees, Orders, Customers 
where Orders.EmployeeID = Employees.EmployeeID 
and Customers.CustomerID = Orders.CustomerID 
and CompanyName = 'Alfreds Futterkiste' 
and YEAR(OrderDate) = 1997  

select ProductName, Products.ProductID 
from Products 
left join [Order Details] 
on Products.ProductID = [Order Details].ProductID  
where [Order Details].ProductID is null

//LAB 5

SELECT CategoryName
FROM Categories 
WHERE Categories.CategoryID NOT IN
(
	SELECT CategoryID
	FROM Products
	WHERE Products.CategoryID is not null
)
	
SELECT EmployeeID
FROM Employees
WHERE EmployeeID NOT IN 
(
	SELECT EmployeeID
	FROM Orders
)

SELECT CustomerID
FROM Customers
WHERE CustomerID NOT IN 
(
	SELECT CustomerID
	FROM Orders
)

SELECT MAX(UnitPrice)
FROM Products

SELECT ProductName
FROM Products
WHERE UnitPrice = 
(
	SELECT MAX(UnitPrice)
	FROM Products
)

SELECT TOP 1 ProductName
FROM Products
ORDER BY UnitPrice DESC	